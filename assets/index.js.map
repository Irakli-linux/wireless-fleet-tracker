{"version":3,"sources":["webpack:///index.js","webpack:///./js/app.js","webpack:///./js/dashboardView.js","webpack:///./js/loginView.js","webpack:///./js/vehicleListView.js","webpack:///./index.html","webpack:///external \"angular\"","webpack:///external {\"amd\":\"angular-route\"}","webpack:///./js/index.js","webpack:///./views/dashboard.html","webpack:///./views/login.html","webpack:///./views/vehicle.html","webpack:///./views/vehicle_list.html","webpack:///external \"Twilio.Sync\"","webpack:///./js/vehicleView.js"],"names":["webpackJsonp","126","module","exports","__webpack_require__","moment","callbacks","subscribeToVehicleData","id","syncClient","list","then","getItems","limit","page","console","info","items","length","vehicles","driving_data","map","item","data","value","index","onVehicleData","on","push","token","auth","$","SyncClient","Client","updateToken","cb","that","this","get","result","success","log","setTimeout","bind","ttl","error","authFailed","fail","jqXHR","textStatus","refreshVehicleList","i","vehicle","unique_name","name","friendly_name","created_at","date_created","format","refresh","addVehicle","newVehicle","callback","vehicleAdded","key","sid","secret","deleteVehicle","vehicleId","generateKey","checkLoggedIn","authRequired","login","username","password","onAuthenticated","init","127","all_maps","infowindows_map","vehicleView","dashboardView","mapElementName","newMap","initMapElement","infowindows","addDataToMap","onVehicleStats","stats","vehicleElemementName","updateStats","128","loginView","app","click","129","vehicleListView","hide","fadeIn","val","onVehicleAddingFailed","err","text","JSON","stringify","onVehicleAdded","131","p","132","angular","133","undefined","134","initVehicleStats","n_data_map","total_speed_map","total_driver_scores_map","updateVehicleStats","n_data","total_speed","total_driver_scores","miles","toFixed","avg_speed","driver_score","fuel","brake","runtime","speed","avgT","latestStats","currentView","$currentViewScope","App","window","$apply","location","href","reason","controller","$scope","$timeout","forEach","$routeParams","copy","generateVehicleKey","config","$routeProvider","when","templateUrl","otherwise","redirectTo","163","path","run","c","put","164","165","166","171","Twilio","Sync","6","google","maps","Map","document","getElementById","zoom","latLon","lat","lng","lon","marker","Marker","position","title","String","content_string","infowindow","InfoWindow","content","panTo","getPosition","event","addListener","e","current_infowindow","close","getTitle","open","runtime_string","hours","Math","floor","minutes"],"mappings":"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","file":"index.js","sourcesContent":["webpackJsonp([0],{\n\n/***/ 126:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nconst MOMENT_FORMAT = \"MMM DD YYYY @ hh:mm\";\n\nvar moment = __webpack_require__(0);\n\nmodule.exports = function(callbacks) {\n  var $ = __webpack_require__(1);\n  var SyncClient = __webpack_require__(171).Client;\n  var syncClient;\n  var token;\n  var auth;\n\n  var vehicles = {};\n\n  function subscribeToVehicleData(id) {\n    syncClient.list(\"vehicle-\" + id + \"-data\").then(function (list) {\n      list.getItems({ limit: 100 }).then(function (page) {\n        console.info(\"items arrived\", id, page.items.length);\n        vehicles[id].driving_data = page.items.map(function (item) {\n          item.data.value.id = item.index;\n          callbacks.onVehicleData(vehicles[id], item.data.value);\n          return item.data.value;\n        });\n      });\n      list.on(\"itemAdded\", function (item) {\n        console.info(\"itemAdded\", id, item);\n        item.data.value.id = item.index;\n        vehicles[id].driving_data.push(item.data.value);\n        callbacks.onVehicleData(vehicles[id], item.data.value);\n      });\n    });\n  };\n\n\treturn {\n    vehicles: vehicles,\n\n    updateToken: function (cb) {\n      var that = this;\n      return $.get(\"/authenticate?\" + auth, function (result) {\n        if (result.success) {\n          console.log(\"token updated:\", result);\n          token = result.token;\n          if (cb) cb(token);\n          syncClient.updateToken(token);\n          setTimeout(that.updateToken.bind(that), result.ttl*1000 * 0.96); // update token slightly in adance of ttl\n        } else {\n          console.error(\"failed to authenticate the user: \", result.error);\n          auth=\"\";\n          callbacks.authFailed(result.error);\n        }\n      }).fail(function (jqXHR, textStatus, error) {\n        console.error(\"failed to send authentication request:\", textStatus, error);\n        auth=\"\";\n        callbacks.authFailed(error);\n      });\n    },\n\n    refreshVehicleList: function () {\n      $.get(\"/fleetmanager?\"+ auth + \"&op=list\", function (result) {\n        if (result.success) {\n          for (var i in result.vehicles) {\n            var vehicle = result.vehicles[i];\n            var id = vehicle.unique_name;\n            vehicles[id] = {\n              info: {\n                id: id,\n                name: vehicle.friendly_name,\n                created_at: moment(vehicle.date_created).format(MOMENT_FORMAT)\n              },\n              driving_data: []\n            };\n            subscribeToVehicleData(id);\n          }\n          callbacks.refresh();\n        } else {\n          console.error(\"failed to list vehicles:\", result);\n        }\n      }).fail(function (jqXHR, textStatus, error) {\n        console.error(\"failed to send list vehicles request:\", textStatus, error);\n      });\n    },\n\n    addVehicle: function (newVehicle, callback) {\n      $.get(\"/fleetmanager?\" + auth + \"&op=add&vehicle_id=\"+(newVehicle.id||\"\")+\"&vehicle_name=\"+(newVehicle.name||\"\"), function (result) {\n        if (result.success) {\n          var vehicleAdded = {\n            info: {\n              created_at: moment(result.vehicle.date_created).format(MOMENT_FORMAT),\n              id: result.vehicle.unique_name,\n              name: result.vehicle.friendly_name,\n              key: result.key.sid,\n              secret: result.key.secret\n            },\n            driving_data: []\n          };\n          vehicles[result.vehicle.unique_name] = vehicleAdded;          \n          subscribeToVehicleData(result.vehicle.unique_name);\n          callback(null, vehicleAdded);\n        } else {\n          callback(result);\n        }\n      }).fail(function (jqXHR, textStatus, error) {\n        console.error(\"failed to send add vehicle request:\", textStatus, error);\n      });\n    },\n\n    deleteVehicle: function (vehicleId) {\n      $.get(\"/fleetmanager?\"+ auth + \"&op=delete&vehicle_id=\"+vehicleId, function (result) {\n        if (result.success) {\n          delete vehicles[vehicleId];\n          callbacks.refresh();\n        } else {\n          console.error(\"failed to delete vehicle\", result);\n        }\n      }).fail(function (jqXHR, textStatus, error) {\n        console.error(\"failed to send delete vehicle request:\", textStatus, error);\n      });\n    },\n\n    generateKey: function (vehicleId) {\n      $.get(\"/fleetmanager?\"+ auth + \"&op=genkey&vehicle_id=\"+vehicleId, function (result) {\n        if (result.success) {\n          vehicles[vehicleId].info.key = result.key.sid;\n          vehicles[vehicleId].info.secret = result.key.secret;\n          callbacks.refresh();\n        } else {\n          console.error(\"failed to generate key\", result);\n        }\n      }).fail(function (jqXHR, textStatus, error) {\n        console.error(\"failed to send generate key request:\", textStatus, error);\n      });\n    },\n\n    checkLoggedIn: function () {\n      if (!auth) {\n        callbacks.authRequired();\n      }\n    },\n\n    login: function (username, password) {\n      var that = this;\n      auth = \"username=\" + username + \"&pincode=\" + password;\n      this.updateToken(function (token) {\n        syncClient = new SyncClient(token);\n        that.refreshVehicleList();\n        callbacks.onAuthenticated();\n      });\n    },\n\n    init: function () {\n      this.checkLoggedIn();\n    }\n\t};\n};\n\n\n/***/ }),\n\n/***/ 127:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(163);\n\nvar vehicleView = __webpack_require__(6);\n\nvar all_maps;\nvar infowindows_map;\n\nvar dashboardView = {\n  init: function () {\n    all_maps = {};\n    infowindows_map = {};\n  },\n\n  onVehicleData: function (vehicle, data) {\n    if (!infowindows_map[vehicle.info.id]) {\n      var mapElementName = 'map-'+vehicle.info.id;\n      var newMap = vehicleView.initMapElement(mapElementName);\n      all_maps[vehicle.info.id] = newMap;  \n      infowindows_map[vehicle.info.id] = {};\n    }\n    var map = all_maps[vehicle.info.id];\n    var infowindows = infowindows_map[vehicle.info.id];\n    vehicleView.addDataToMap(map, infowindows, data);\n  },\n\n  onVehicleStats: function (vehicle, stats) {\n    if (!stats) return;\n\n    var vehicleElemementName = 'vehicle'+vehicle.info.id;\n\n    vehicleView.updateStats(vehicleElemementName, stats);\n  }\n};\n\nmodule.exports = dashboardView;\n\n\n/***/ }),\n\n/***/ 128:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(164);\n\nvar loginView = {\n    init: function (app, auth) {\n        $('#input-form-submit').click(function () {\n            app.login(auth.username, auth.password);\n        });\n    }\n};\n\nmodule.exports = loginView;\n\n\n/***/ }),\n\n/***/ 129:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(166);\n\nvar $ = __webpack_require__(1);\n\nvar vehicleListView = {\n  init: function () {\n    $('.add-vehicle-show').click(function() {\n      $(this).hide();\n      $('.add-vehicle').fadeIn(333);\n      $('#id').val('');\n      $('#name').val('');\n      $('#sim_sid').val('');\n    });\n    $('.add-vehicle-cancel').click(function() {\n      $('.add-vehicle').hide();\n      $('.add-vehicle-show').fadeIn(333);\n    });\n  },\n\n  onVehicleAddingFailed: function (err) {\n    $('#add-vehicle-failed').text(JSON.stringify(err));\n  },\n\n  onVehicleAdded: function () {\n    $('.add-vehicle').hide();\n    $('.add-vehicle-show').fadeIn(333);\n  }\n}\n\nmodule.exports = vehicleListView;\n\n\n/***/ }),\n\n/***/ 131:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"index.html\";\n\n/***/ }),\n\n/***/ 132:\n/***/ (function(module, exports) {\n\nmodule.exports = angular;\n\n/***/ }),\n\n/***/ 133:\n/***/ (function(module, exports) {\n\nmodule.exports = undefined;\n\n/***/ }),\n\n/***/ 134:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar angular = __webpack_require__(132);\n__webpack_require__(133);\n\n// style sheets\n__webpack_require__(3);\n__webpack_require__(4);\n\n// index.html\n__webpack_require__(131);\n\nvar loginView = __webpack_require__(128);\nvar dashboardView = __webpack_require__(127);\nvar vehicleView = __webpack_require__(6);\nvar vehicleListView = __webpack_require__(129);\nvar currentView;\nvar $currentViewScope;\n\nvar auth = {};\nvar n_data_map = {};\nvar total_speed_map = {};\nvar total_driver_scores_map = {};\nvar current_infowindow = null;\nvar latestStats = null;\n\nfunction initVehicleStats(vehicle) {\n  if (!(vehicle.info.id in n_data_map)) {\n    n_data_map[vehicle.info.id] = 0;\n    total_speed_map[vehicle.info.id] = 0;\n    total_driver_scores_map[vehicle.info.id] = 0;\n  }\n}\n\nfunction updateVehicleStats(vehicle, data) {\n  initVehicleStats(vehicle);\n\n  var n_data = ++n_data_map[vehicle.info.id];\n  var total_speed = total_speed_map[vehicle.info.id];\n  var total_driver_scores = total_driver_scores_map[vehicle.info.id];\n\n  var stats = {\n    miles : (data.miles).toFixed(0),\n    avg_speed : (total_speed/n_data).toFixed(0),\n    driver_score : (total_driver_scores/n_data).toFixed(0),\n    fuel : (data.fuel).toFixed(0),\n    brake : (data.brake).toFixed(0),\n    runtime : data.runtime\n  };\n\n  total_speed_map[vehicle.info.id] =  total_speed_map[vehicle.info.id] + data.speed;\n  total_driver_scores_map[vehicle.info.id] = total_driver_scores_map[vehicle.info.id] + data.avgT;\n\n  latestStats = stats;\n}\n\nvar App = __webpack_require__(126);\nwindow.app = new App({\n  refresh: function () {\n    $currentViewScope.$apply();\n  },\n\n  onVehicleData: function (vehicle, data) {\n    updateVehicleStats(vehicle, data);\n    if (currentView.onVehicleData) currentView.onVehicleData(vehicle, data);\n    if (currentView.onVehicleStats) currentView.onVehicleStats(vehicle, latestStats);\n  },\n\n  onAuthenticated: function () {\n    window.location.href = '/#!/dashboard';\n    $currentViewScope.$apply();\n  },\n\n  authFailed: function (reason) {\n    auth.reason = reason;\n    window.location.href = '/#!/login';\n    $currentViewScope.$apply();\n  },\n\n  authRequired: function () {\n    auth.reason = \"\";\n    window.location.href = '/#!/login';\n  },\n});\n\nangular\n  .module(\"app\", [\n    'ngRoute'\n  ])\n  .controller('LoginViewCtrl', ['$scope', '$timeout', function ($scope, $timeout) {\n    $currentViewScope = $scope;\n    $scope.auth = auth;\n    currentView = loginView;\n    loginView.init(app, $scope.auth);\n    $timeout(function () {\n        \n    });\n  }])\n  .controller('DashboardViewCtrl', ['$scope', '$timeout', function ($scope, $timeout) {\n    app.checkLoggedIn();\n    $currentViewScope = $scope;\n    $scope.vehicles = app.vehicles;\n    currentView = dashboardView;\n    dashboardView.init();\n    // use timeout service to wait until view is loaded\n    $timeout(function () {\n      for (var id in $scope.vehicles) {\n        var vehicle = $scope.vehicles[id];\n        vehicle.driving_data.forEach(function (data) {\n          dashboardView.onVehicleData(vehicle, data);\n        });\n        dashboardView.onVehicleStats(vehicle, latestStats);\n      }\n    }, 0);\n  }])\n  .controller('VehicleViewCtrl', ['$routeParams', '$scope', '$timeout', function ($routeParams, $scope, $timeout) {\n    app.checkLoggedIn();\n    $currentViewScope = $scope;\n    $scope.vehicles = app.vehicles;\n    $scope.id = $routeParams.id;\n    var vehicle = app.vehicles[$routeParams.id];\n    currentView = vehicleView;\n    vehicleView.init();\n    if (vehicle) {\n      $timeout(function () {\n        vehicle.driving_data.forEach(function (data) {\n          vehicleView.onVehicleData(vehicle.info.id, data);\n        });\n        vehicleView.onVehicleStats(vehicle, latestStats);\n      }, 0);\n    }\n  }])\n  .controller('VehicleListViewCtrl', ['$scope', '$timeout', function ($scope, $timeout) {\n    app.checkLoggedIn();\n    $currentViewScope = $scope;\n    $scope.vehicles = app.vehicles;\n    $scope.newVehicle = {};\n    $scope.addVehicle = function () {\n      var err = app.addVehicle(angular.copy($scope.newVehicle), function (err, vehicleAdded) {\n        if (err) {\n          vehicleListView.onVehicleAddingFailed(err);\n        } else {\n          $scope.vehicleAdded = vehicleAdded;\n          vehicleListView.onVehicleAdded();\n          $scope.$apply();\n        }\n      });\n    };\n    $scope.deleteVehicle = function (vehicleId) {\n      app.deleteVehicle(vehicleId);\n    };\n    $scope.generateVehicleKey = function (vehicleId) {\n      app.generateKey(vehicleId);\n    };\n    currentView = vehicleListView;\n    vehicleListView.init();\n  }])\n  .config(['$routeProvider', function ($routeProvider) {\n    $routeProvider\n      .when('/dashboard', { controller: 'DashboardViewCtrl', templateUrl: \"views/dashboard.html\" } )\n      .when('/vehicles/:id', { controller: 'VehicleViewCtrl', templateUrl: \"views/vehicle.html\" } )\n      .when('/vehicles', { controller: 'VehicleListViewCtrl', templateUrl: \"views/vehicle_list.html\" } )\n      .when('/login', { controller: 'LoginViewCtrl', templateUrl: 'views/login.html' })\n      .otherwise({ redirectTo: '/dashboard' }); \n  }]);\n\n\n/***/ }),\n\n/***/ 163:\n/***/ (function(module, exports) {\n\nvar path = 'views/dashboard.html';\nvar html = \"<h1>Active Vehicles</h1>\\n\\n<h3 ng-hide=\\\"vehicles.length\\\" class=\\\"ng-hide\\\">There are currently no vehicles on the road.</h3>\\n\\n<div ng-repeat=\\\"vehicle in vehicles\\\" class=\\\"jumbotron vehicle vehicle{{vehicle.info.id}}\\\">\\n  <h3>{{ vehicle.info.id }} | {{vehicle.info.name}} <a href=\\\"#!/vehicles/{{vehicle.info.id}}\\\">(view past drives)</a></h3>\\n  <h4>Current trip time: <span class=\\\"runtime\\\">0</span></h4>\\n  <div class=\\\"row map-cont\\\">\\n    <div class=\\\"col-lg-12\\\">\\n      <div class=\\\"map\\\" id=\\\"map-{{vehicle.info.id}}\\\"></div>\\n    </div>\\n  </div>\\n  <div class=\\\"row\\\">\\n    <div class=\\\"col-lg-2 col-lg-offset-1\\\">\\n      <div class=\\\"panel panel-info\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Trip Distance</h3>\\n        </div>\\n        <div class=\\\"panel-body miles\\\">\\n          <span>00</span> miles\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-success\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Average Speed</h3>\\n        </div>\\n        <div class=\\\"panel-body speed\\\">\\n          <span>00</span> mph\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-danger\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Hard Brakes</h3>\\n        </div>\\n        <div class=\\\"panel-body brake\\\">\\n          <span>00</span>\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-warning\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Driver Score</h3>\\n        </div>\\n        <div class=\\\"panel-body driver_score\\\">\\n          <span>00</span>\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-danger\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Fuel Guage</h3>\\n        </div>\\n        <div class=\\\"panel-body fuel\\\">\\n          <span>00</span>%\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/***/ }),\n\n/***/ 164:\n/***/ (function(module, exports) {\n\nvar path = 'views/login.html';\nvar html = \"<div class=\\\"login-form container\\\">\\n    <p id=\\\"login-reason\\\" class=\\\"text-warning\\\">{{ auth.reason }}</p>\\n    <label><b>Username</b></label>\\n    <input type=\\\"text\\\" id=\\\"input-form-username\\\" placeholder=\\\"Enter Username\\\" ng-model=\\\"auth.username\\\">\\n\\n    <label><b>Password</b></label>\\n    <input type=\\\"password\\\" id=\\\"input-form-password\\\" placeholder=\\\"Enter Password\\\" ng-model=\\\"auth.password\\\">\\n\\n    <button id=\\\"input-form-submit\\\" type=\\\"submit\\\">Login</button>\\n</div>\\n\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/***/ }),\n\n/***/ 165:\n/***/ (function(module, exports) {\n\nvar path = 'views/vehicle.html';\nvar html = \"<div class=\\\"jumbotron vehicle \\\">\\n  <h3>{{vehicles[id].info.name}}</h3>\\n  <h4>Total trip time: <span class=\\\"runtime\\\">0</span></h4>\\n  <div class=\\\"row map-cont\\\">\\n    <div class=\\\"col-lg-12\\\">\\n      <div class=\\\"map\\\" id=\\\"map\\\"></div>\\n    </div>\\n  </div>\\n  <div class=\\\"row\\\">\\n    <div class=\\\"col-lg-2 col-lg-offset-1\\\">\\n      <div class=\\\"panel panel-info\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Trip Distance</h3>\\n        </div>\\n        <div class=\\\"panel-body miles\\\">\\n          <span>00</span> miles\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-success\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Average Speed</h3>\\n        </div>\\n        <div class=\\\"panel-body speed\\\">\\n          <span>00</span> mph\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-danger\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Hard Brakes</h3>\\n        </div>\\n        <div class=\\\"panel-body brake\\\">\\n          <span>00</span>\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-warning\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Driver Score</h3>\\n        </div>\\n        <div class=\\\"panel-body driver_score\\\">\\n          <span>00</span>\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-danger\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Fuel Guage</h3>\\n        </div>\\n        <div class=\\\"panel-body fuel\\\">\\n          <span>00</span>%\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/***/ }),\n\n/***/ 166:\n/***/ (function(module, exports) {\n\nvar path = 'views/vehicle_list.html';\nvar html = \"<div class=\\\"row\\\">\\n  <div class=\\\"col-lg-12\\\">\\n    <div class=\\\"page-header\\\">\\n      <h1 id=\\\"tables\\\">Vehicles</h1>\\n    </div>\\n    <div class=\\\"bs-component\\\">\\n      <table class=\\\"table table-striped table-hover \\\">\\n        <thead>\\n          <tr>\\n            <th>Id</th>\\n            <th>Name</th>\\n<!--\\n            <th>Twilio SIM SID</th>\\n-->\\n            <th>Key</th>\\n            <th>Created</th>\\n            <th>Operations</th>\\n          </tr>\\n        </thead>\\n        <tbody>\\n          <tr ng-repeat=\\\"vehicle in vehicles\\\" class=\\\"jumbotron vehicle vehicle{{vehicle.info.id}}\\\" ng-class=\\\"{'text-success': vehicleAdded.info.id === vehicle.info.id}\\\">\\n            <td>{{ vehicle.info.id }}</td>\\n            <td>{{ vehicle.info.name }}</td>\\n<!--\\n            <td>{{ vehicle.info.sim_sid }}</td>\\n            <td>{{ vehicle.info.key }} <small ng-if=\\\"vehicle.info.secret\\\" class=\\\"text-warning\\\"><br/>Secret: {{ vehicle.info.secret }}</small></td>\\n-->\\n            <td>\\n              <div ng-if=\\\"vehicle.info.key\\\">{{ vehicle.info.key }} <small class=\\\"text-warning\\\"><br/>Secret: {{ vehicle.info.secret }}</small></div>\\n              <div ng-if=\\\"!vehicle.info.key\\\" class=\\\"text-danger\\\">Hidden</div>\\n            </td>\\n            <td>{{ vehicle.info.created_at }}</td>\\n<!--\\n            <td><a href=\\\"#!/vehicles/{{ vehicle.info.id }}/edit\\\" class=\\\"btn btn-xs btn-success\\\">Edit</a></td>\\n-->\\n            <td>\\n              <button ng-click=\\\"generateVehicleKey(vehicle.info.id)\\\" class=\\\"btn btn-xs btn-danger\\\">Generate New Key</button>\\n              <button ng-click=\\\"deleteVehicle(vehicle.info.id)\\\" class=\\\"btn btn-xs btn-danger\\\">Delete</button>\\n            </td>\\n          </tr>\\n        </tbody>\\n      </table>\\n    <div id=\\\"source-button\\\" class=\\\"btn btn-primary btn-xs\\\" style=\\\"display: none;\\\">&lt; &gt;</div></div>\\n  </div>\\n  <div class=\\\"divider col-lg-10 bg-primary\\\"></div>\\n</div>\\n\\n<a class=\\\"btn btn-primary add-vehicle-show\\\">Add New Vehicle</a>\\n\\n<div class=\\\"row add-vehicle\\\">\\n  <div class=\\\"col-lg-6\\\">\\n    <form class=\\\"form-horizontal\\\" ng-submit=\\\"addVehicle()\\\">\\n      <fieldset>\\n        <legend>New Vehicle</legend>\\n        <div class=\\\"form-group\\\">\\n          <label for=\\\"id\\\" class=\\\"col-lg-2 control-label\\\">Id</label>\\n          <div class=\\\"col-lg-10\\\">\\n            <input type=\\\"text\\\" class=\\\"form-control\\\" ng-model=\\\"newVehicle.id\\\" id=\\\"id\\\" placeholder=\\\"Id\\\">\\n          </div>\\n        </div>\\n\\n        <div class=\\\"form-group\\\">\\n          <label for=\\\"name\\\" class=\\\"col-lg-2 control-label\\\">Name</label>\\n          <div class=\\\"col-lg-10\\\">\\n            <input type=\\\"text\\\" class=\\\"form-control\\\" ng-model=\\\"newVehicle.name\\\" id=\\\"name\\\" placeholder=\\\"Name\\\">\\n          </div>\\n        </div>\\n\\n<!--\\n        <div class=\\\"form-group\\\">\\n          <label for=\\\"sim_sid\\\" class=\\\"col-lg-2 control-label\\\">Twilio SIM SID</label>\\n          <div class=\\\"col-lg-10\\\">\\n            <input type=\\\"text\\\" class=\\\"form-control\\\" ng-model=\\\"newVehicle.sim_sid\\\" id=\\\"sim_sid\\\" placeholder=\\\"Twilio SIM SID\\\">\\n          </div>\\n        </div>\\n-->\\n\\n        <div class=\\\"form-group\\\">\\n          <div class=\\\"col-lg-10 col-lg-offset-2\\\">\\n            <button type=\\\"submit\\\" class=\\\"btn btn-primary\\\">Submit</button>\\n            <button type=\\\"reset\\\" class=\\\"btn btn-default add-vehicle-cancel\\\">Cancel</button>\\n          </div>\\n        </div>\\n\\n        <p class=\\\"text-warning\\\" id=\\\"add-vehicle-failed\\\"></p>\\n      </fieldset>\\n    </form>\\n  </div>\\n</div>\\n\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n/***/ }),\n\n/***/ 171:\n/***/ (function(module, exports) {\n\nmodule.exports = Twilio.Sync;\n\n/***/ }),\n\n/***/ 6:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(165);\n\nvar $ = __webpack_require__(1);\n\nvar map;\nvar infowindows = {};\n\nvar vehicleView = {\n  initMapElement: function (mapElementName) {\n    var map = new google.maps.Map(document.getElementById(mapElementName), {\n      zoom: 14\n    });\n    return map;\n  },\n\n  addDataToMap: function (map, infowindows, data) {\n    var latLon = { lat: data.lat, lng: data.lon}\n    var marker = new google.maps.Marker({\n      position: latLon,\n      map: map,\n      title: String(data.id)\n    });\n\n    var content_string = '<div class=\"infowindow-label\"> \\\n                            <h1>Point data</h1> \\\n                            <p><span class=\"label label-default\">Distance:</span> <span class=\"value\">'+(data.miles).toFixed(0)+' Miles</span></p> \\\n                            <p><span class=\"label label-default\">Speed:</span> <span class=\"value\">'+(data.speed).toFixed(0)+' mph</span></p> \\\n                            <p><span class=\"label label-default\">Fuel:</span> <span class=\"value\">'+(data.fuel).toFixed(0)+'%</span></p> \\\n                          </div>';\n\n    var infowindow = new google.maps.InfoWindow({\n      content: content_string,\n    });\n    infowindows[data.id] = infowindow;\n    map.panTo(marker.getPosition());\n\n    google.maps.event.addListener(marker, 'click', function(e) {\n      if(current_infowindow) {\n        current_infowindow.close();\n      }\n      infowindows[this.getTitle()].open(map, this);\n      current_infowindow = infowindows[this.getTitle()];\n    });\n  },\n\n  updateStats: function (vehicleElemementName, stats) {\n    if (!stats) return;\n\n    $('.' + vehicleElemementName + ' .miles span').text(stats.miles);\n    $('.' + vehicleElemementName + ' .speed span').text(stats.avg_speed);\n    $('.' + vehicleElemementName + ' .driver_score span').text(100 - stats.driver_score);\n    $('.' + vehicleElemementName + ' .fuel span').text(stats.fuel);\n    $('.' + vehicleElemementName + ' .brake span').text(stats.brake);\n\n    var runtime_string;\n    if(stats.runtime < 60) {\n      runtime_string = stats.runtime+' seconds';\n    } else if(stats.runtime < 3600) {\n      runtime_string = (stats.runtime/60).toFixed(0)+\" minutes\";\n    } else {\n      var hours = Math.floor(runtime/3600);\n      var minutes = ((runtime - (hours*3600))/60).toFixed(0);\n      runtime_string = hours+\" hours and \"+minutes+\" minutes\";\n    }\n\n    $('.' + vehicleElemementName + ' .runtime').text(runtime_string);    \n  },\n\n  init: function () {\n    map = vehicleView.initMapElement('map');\n  },\n\n  onVehicleData: function (vehicle, data) {\n    vehicleView.addDataToMap(map, infowindows, data);\n  },\n\n  onVehicleStats: function (vehicle, stats) {\n    vehicleView.updateStats('vehicle', stats);\n  }  \n};\n\nmodule.exports = vehicleView;\n\n\n/***/ })\n\n},[134]);\n\n\n// WEBPACK FOOTER //\n// index.js","'use strict';\n\nconst MOMENT_FORMAT = \"MMM DD YYYY @ hh:mm\";\n\nvar moment = require(\"moment\");\n\nmodule.exports = function(callbacks) {\n  var $ = require(\"jquery\");\n  var SyncClient = require(\"twilio-sync\").Client;\n  var syncClient;\n  var token;\n  var auth;\n\n  var vehicles = {};\n\n  function subscribeToVehicleData(id) {\n    syncClient.list(\"vehicle-\" + id + \"-data\").then(function (list) {\n      list.getItems({ limit: 100 }).then(function (page) {\n        console.info(\"items arrived\", id, page.items.length);\n        vehicles[id].driving_data = page.items.map(function (item) {\n          item.data.value.id = item.index;\n          callbacks.onVehicleData(vehicles[id], item.data.value);\n          return item.data.value;\n        });\n      });\n      list.on(\"itemAdded\", function (item) {\n        console.info(\"itemAdded\", id, item);\n        item.data.value.id = item.index;\n        vehicles[id].driving_data.push(item.data.value);\n        callbacks.onVehicleData(vehicles[id], item.data.value);\n      });\n    });\n  };\n\n\treturn {\n    vehicles: vehicles,\n\n    updateToken: function (cb) {\n      var that = this;\n      return $.get(\"/authenticate?\" + auth, function (result) {\n        if (result.success) {\n          console.log(\"token updated:\", result);\n          token = result.token;\n          if (cb) cb(token);\n          syncClient.updateToken(token);\n          setTimeout(that.updateToken.bind(that), result.ttl*1000 * 0.96); // update token slightly in adance of ttl\n        } else {\n          console.error(\"failed to authenticate the user: \", result.error);\n          auth=\"\";\n          callbacks.authFailed(result.error);\n        }\n      }).fail(function (jqXHR, textStatus, error) {\n        console.error(\"failed to send authentication request:\", textStatus, error);\n        auth=\"\";\n        callbacks.authFailed(error);\n      });\n    },\n\n    refreshVehicleList: function () {\n      $.get(\"/fleetmanager?\"+ auth + \"&op=list\", function (result) {\n        if (result.success) {\n          for (var i in result.vehicles) {\n            var vehicle = result.vehicles[i];\n            var id = vehicle.unique_name;\n            vehicles[id] = {\n              info: {\n                id: id,\n                name: vehicle.friendly_name,\n                created_at: moment(vehicle.date_created).format(MOMENT_FORMAT)\n              },\n              driving_data: []\n            };\n            subscribeToVehicleData(id);\n          }\n          callbacks.refresh();\n        } else {\n          console.error(\"failed to list vehicles:\", result);\n        }\n      }).fail(function (jqXHR, textStatus, error) {\n        console.error(\"failed to send list vehicles request:\", textStatus, error);\n      });\n    },\n\n    addVehicle: function (newVehicle, callback) {\n      $.get(\"/fleetmanager?\" + auth + \"&op=add&vehicle_id=\"+(newVehicle.id||\"\")+\"&vehicle_name=\"+(newVehicle.name||\"\"), function (result) {\n        if (result.success) {\n          var vehicleAdded = {\n            info: {\n              created_at: moment(result.vehicle.date_created).format(MOMENT_FORMAT),\n              id: result.vehicle.unique_name,\n              name: result.vehicle.friendly_name,\n              key: result.key.sid,\n              secret: result.key.secret\n            },\n            driving_data: []\n          };\n          vehicles[result.vehicle.unique_name] = vehicleAdded;          \n          subscribeToVehicleData(result.vehicle.unique_name);\n          callback(null, vehicleAdded);\n        } else {\n          callback(result);\n        }\n      }).fail(function (jqXHR, textStatus, error) {\n        console.error(\"failed to send add vehicle request:\", textStatus, error);\n      });\n    },\n\n    deleteVehicle: function (vehicleId) {\n      $.get(\"/fleetmanager?\"+ auth + \"&op=delete&vehicle_id=\"+vehicleId, function (result) {\n        if (result.success) {\n          delete vehicles[vehicleId];\n          callbacks.refresh();\n        } else {\n          console.error(\"failed to delete vehicle\", result);\n        }\n      }).fail(function (jqXHR, textStatus, error) {\n        console.error(\"failed to send delete vehicle request:\", textStatus, error);\n      });\n    },\n\n    generateKey: function (vehicleId) {\n      $.get(\"/fleetmanager?\"+ auth + \"&op=genkey&vehicle_id=\"+vehicleId, function (result) {\n        if (result.success) {\n          vehicles[vehicleId].info.key = result.key.sid;\n          vehicles[vehicleId].info.secret = result.key.secret;\n          callbacks.refresh();\n        } else {\n          console.error(\"failed to generate key\", result);\n        }\n      }).fail(function (jqXHR, textStatus, error) {\n        console.error(\"failed to send generate key request:\", textStatus, error);\n      });\n    },\n\n    checkLoggedIn: function () {\n      if (!auth) {\n        callbacks.authRequired();\n      }\n    },\n\n    login: function (username, password) {\n      var that = this;\n      auth = \"username=\" + username + \"&pincode=\" + password;\n      this.updateToken(function (token) {\n        syncClient = new SyncClient(token);\n        that.refreshVehicleList();\n        callbacks.onAuthenticated();\n      });\n    },\n\n    init: function () {\n      this.checkLoggedIn();\n    }\n\t};\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./js/app.js\n// module id = 126\n// module chunks = 0","require(\"../views/dashboard.html\");\n\nvar vehicleView = require(\"./vehicleView\");\n\nvar all_maps;\nvar infowindows_map;\n\nvar dashboardView = {\n  init: function () {\n    all_maps = {};\n    infowindows_map = {};\n  },\n\n  onVehicleData: function (vehicle, data) {\n    if (!infowindows_map[vehicle.info.id]) {\n      var mapElementName = 'map-'+vehicle.info.id;\n      var newMap = vehicleView.initMapElement(mapElementName);\n      all_maps[vehicle.info.id] = newMap;  \n      infowindows_map[vehicle.info.id] = {};\n    }\n    var map = all_maps[vehicle.info.id];\n    var infowindows = infowindows_map[vehicle.info.id];\n    vehicleView.addDataToMap(map, infowindows, data);\n  },\n\n  onVehicleStats: function (vehicle, stats) {\n    if (!stats) return;\n\n    var vehicleElemementName = 'vehicle'+vehicle.info.id;\n\n    vehicleView.updateStats(vehicleElemementName, stats);\n  }\n};\n\nmodule.exports = dashboardView;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./js/dashboardView.js\n// module id = 127\n// module chunks = 0","require(\"../views/login.html\");\n\nvar loginView = {\n    init: function (app, auth) {\n        $('#input-form-submit').click(function () {\n            app.login(auth.username, auth.password);\n        });\n    }\n};\n\nmodule.exports = loginView;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./js/loginView.js\n// module id = 128\n// module chunks = 0","require(\"../views/vehicle_list.html\");\n\nvar $ = require(\"jquery\");\n\nvar vehicleListView = {\n  init: function () {\n    $('.add-vehicle-show').click(function() {\n      $(this).hide();\n      $('.add-vehicle').fadeIn(333);\n      $('#id').val('');\n      $('#name').val('');\n      $('#sim_sid').val('');\n    });\n    $('.add-vehicle-cancel').click(function() {\n      $('.add-vehicle').hide();\n      $('.add-vehicle-show').fadeIn(333);\n    });\n  },\n\n  onVehicleAddingFailed: function (err) {\n    $('#add-vehicle-failed').text(JSON.stringify(err));\n  },\n\n  onVehicleAdded: function () {\n    $('.add-vehicle').hide();\n    $('.add-vehicle-show').fadeIn(333);\n  }\n}\n\nmodule.exports = vehicleListView;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./js/vehicleListView.js\n// module id = 129\n// module chunks = 0","module.exports = __webpack_public_path__ + \"index.html\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./index.html\n// module id = 131\n// module chunks = 0","module.exports = angular;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"angular\"\n// module id = 132\n// module chunks = 0","module.exports = undefined;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"amd\":\"angular-route\"}\n// module id = 133\n// module chunks = 0","'use strict';\n\nvar angular = require(\"angular\");\nrequire(\"angular-route\");\n\n// style sheets\nrequire(\"bootstrap-webpack\");\nrequire(\"../scss/main.scss\");\n\n// index.html\nrequire(\"../index.html\");\n\nvar loginView = require(\"./loginView.js\");\nvar dashboardView = require(\"./dashboardView\");\nvar vehicleView = require(\"./vehicleView\");\nvar vehicleListView = require(\"./vehicleListView\");\nvar currentView;\nvar $currentViewScope;\n\nvar auth = {};\nvar n_data_map = {};\nvar total_speed_map = {};\nvar total_driver_scores_map = {};\nvar current_infowindow = null;\nvar latestStats = null;\n\nfunction initVehicleStats(vehicle) {\n  if (!(vehicle.info.id in n_data_map)) {\n    n_data_map[vehicle.info.id] = 0;\n    total_speed_map[vehicle.info.id] = 0;\n    total_driver_scores_map[vehicle.info.id] = 0;\n  }\n}\n\nfunction updateVehicleStats(vehicle, data) {\n  initVehicleStats(vehicle);\n\n  var n_data = ++n_data_map[vehicle.info.id];\n  var total_speed = total_speed_map[vehicle.info.id];\n  var total_driver_scores = total_driver_scores_map[vehicle.info.id];\n\n  var stats = {\n    miles : (data.miles).toFixed(0),\n    avg_speed : (total_speed/n_data).toFixed(0),\n    driver_score : (total_driver_scores/n_data).toFixed(0),\n    fuel : (data.fuel).toFixed(0),\n    brake : (data.brake).toFixed(0),\n    runtime : data.runtime\n  };\n\n  total_speed_map[vehicle.info.id] =  total_speed_map[vehicle.info.id] + data.speed;\n  total_driver_scores_map[vehicle.info.id] = total_driver_scores_map[vehicle.info.id] + data.avgT;\n\n  latestStats = stats;\n}\n\nvar App = require(\"./app\");\nwindow.app = new App({\n  refresh: function () {\n    $currentViewScope.$apply();\n  },\n\n  onVehicleData: function (vehicle, data) {\n    updateVehicleStats(vehicle, data);\n    if (currentView.onVehicleData) currentView.onVehicleData(vehicle, data);\n    if (currentView.onVehicleStats) currentView.onVehicleStats(vehicle, latestStats);\n  },\n\n  onAuthenticated: function () {\n    window.location.href = '/#!/dashboard';\n    $currentViewScope.$apply();\n  },\n\n  authFailed: function (reason) {\n    auth.reason = reason;\n    window.location.href = '/#!/login';\n    $currentViewScope.$apply();\n  },\n\n  authRequired: function () {\n    auth.reason = \"\";\n    window.location.href = '/#!/login';\n  },\n});\n\nangular\n  .module(\"app\", [\n    'ngRoute'\n  ])\n  .controller('LoginViewCtrl', ['$scope', '$timeout', function ($scope, $timeout) {\n    $currentViewScope = $scope;\n    $scope.auth = auth;\n    currentView = loginView;\n    loginView.init(app, $scope.auth);\n    $timeout(function () {\n        \n    });\n  }])\n  .controller('DashboardViewCtrl', ['$scope', '$timeout', function ($scope, $timeout) {\n    app.checkLoggedIn();\n    $currentViewScope = $scope;\n    $scope.vehicles = app.vehicles;\n    currentView = dashboardView;\n    dashboardView.init();\n    // use timeout service to wait until view is loaded\n    $timeout(function () {\n      for (var id in $scope.vehicles) {\n        var vehicle = $scope.vehicles[id];\n        vehicle.driving_data.forEach(function (data) {\n          dashboardView.onVehicleData(vehicle, data);\n        });\n        dashboardView.onVehicleStats(vehicle, latestStats);\n      }\n    }, 0);\n  }])\n  .controller('VehicleViewCtrl', ['$routeParams', '$scope', '$timeout', function ($routeParams, $scope, $timeout) {\n    app.checkLoggedIn();\n    $currentViewScope = $scope;\n    $scope.vehicles = app.vehicles;\n    $scope.id = $routeParams.id;\n    var vehicle = app.vehicles[$routeParams.id];\n    currentView = vehicleView;\n    vehicleView.init();\n    if (vehicle) {\n      $timeout(function () {\n        vehicle.driving_data.forEach(function (data) {\n          vehicleView.onVehicleData(vehicle.info.id, data);\n        });\n        vehicleView.onVehicleStats(vehicle, latestStats);\n      }, 0);\n    }\n  }])\n  .controller('VehicleListViewCtrl', ['$scope', '$timeout', function ($scope, $timeout) {\n    app.checkLoggedIn();\n    $currentViewScope = $scope;\n    $scope.vehicles = app.vehicles;\n    $scope.newVehicle = {};\n    $scope.addVehicle = function () {\n      var err = app.addVehicle(angular.copy($scope.newVehicle), function (err, vehicleAdded) {\n        if (err) {\n          vehicleListView.onVehicleAddingFailed(err);\n        } else {\n          $scope.vehicleAdded = vehicleAdded;\n          vehicleListView.onVehicleAdded();\n          $scope.$apply();\n        }\n      });\n    };\n    $scope.deleteVehicle = function (vehicleId) {\n      app.deleteVehicle(vehicleId);\n    };\n    $scope.generateVehicleKey = function (vehicleId) {\n      app.generateKey(vehicleId);\n    };\n    currentView = vehicleListView;\n    vehicleListView.init();\n  }])\n  .config(['$routeProvider', function ($routeProvider) {\n    $routeProvider\n      .when('/dashboard', { controller: 'DashboardViewCtrl', templateUrl: \"views/dashboard.html\" } )\n      .when('/vehicles/:id', { controller: 'VehicleViewCtrl', templateUrl: \"views/vehicle.html\" } )\n      .when('/vehicles', { controller: 'VehicleListViewCtrl', templateUrl: \"views/vehicle_list.html\" } )\n      .when('/login', { controller: 'LoginViewCtrl', templateUrl: 'views/login.html' })\n      .otherwise({ redirectTo: '/dashboard' }); \n  }]);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./js/index.js\n// module id = 134\n// module chunks = 0","var path = 'views/dashboard.html';\nvar html = \"<h1>Active Vehicles</h1>\\n\\n<h3 ng-hide=\\\"vehicles.length\\\" class=\\\"ng-hide\\\">There are currently no vehicles on the road.</h3>\\n\\n<div ng-repeat=\\\"vehicle in vehicles\\\" class=\\\"jumbotron vehicle vehicle{{vehicle.info.id}}\\\">\\n  <h3>{{ vehicle.info.id }} | {{vehicle.info.name}} <a href=\\\"#!/vehicles/{{vehicle.info.id}}\\\">(view past drives)</a></h3>\\n  <h4>Current trip time: <span class=\\\"runtime\\\">0</span></h4>\\n  <div class=\\\"row map-cont\\\">\\n    <div class=\\\"col-lg-12\\\">\\n      <div class=\\\"map\\\" id=\\\"map-{{vehicle.info.id}}\\\"></div>\\n    </div>\\n  </div>\\n  <div class=\\\"row\\\">\\n    <div class=\\\"col-lg-2 col-lg-offset-1\\\">\\n      <div class=\\\"panel panel-info\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Trip Distance</h3>\\n        </div>\\n        <div class=\\\"panel-body miles\\\">\\n          <span>00</span> miles\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-success\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Average Speed</h3>\\n        </div>\\n        <div class=\\\"panel-body speed\\\">\\n          <span>00</span> mph\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-danger\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Hard Brakes</h3>\\n        </div>\\n        <div class=\\\"panel-body brake\\\">\\n          <span>00</span>\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-warning\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Driver Score</h3>\\n        </div>\\n        <div class=\\\"panel-body driver_score\\\">\\n          <span>00</span>\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-danger\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Fuel Guage</h3>\\n        </div>\\n        <div class=\\\"panel-body fuel\\\">\\n          <span>00</span>%\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./views/dashboard.html\n// module id = 163\n// module chunks = 0","var path = 'views/login.html';\nvar html = \"<div class=\\\"login-form container\\\">\\n    <p id=\\\"login-reason\\\" class=\\\"text-warning\\\">{{ auth.reason }}</p>\\n    <label><b>Username</b></label>\\n    <input type=\\\"text\\\" id=\\\"input-form-username\\\" placeholder=\\\"Enter Username\\\" ng-model=\\\"auth.username\\\">\\n\\n    <label><b>Password</b></label>\\n    <input type=\\\"password\\\" id=\\\"input-form-password\\\" placeholder=\\\"Enter Password\\\" ng-model=\\\"auth.password\\\">\\n\\n    <button id=\\\"input-form-submit\\\" type=\\\"submit\\\">Login</button>\\n</div>\\n\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./views/login.html\n// module id = 164\n// module chunks = 0","var path = 'views/vehicle.html';\nvar html = \"<div class=\\\"jumbotron vehicle \\\">\\n  <h3>{{vehicles[id].info.name}}</h3>\\n  <h4>Total trip time: <span class=\\\"runtime\\\">0</span></h4>\\n  <div class=\\\"row map-cont\\\">\\n    <div class=\\\"col-lg-12\\\">\\n      <div class=\\\"map\\\" id=\\\"map\\\"></div>\\n    </div>\\n  </div>\\n  <div class=\\\"row\\\">\\n    <div class=\\\"col-lg-2 col-lg-offset-1\\\">\\n      <div class=\\\"panel panel-info\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Trip Distance</h3>\\n        </div>\\n        <div class=\\\"panel-body miles\\\">\\n          <span>00</span> miles\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-success\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Average Speed</h3>\\n        </div>\\n        <div class=\\\"panel-body speed\\\">\\n          <span>00</span> mph\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-danger\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Hard Brakes</h3>\\n        </div>\\n        <div class=\\\"panel-body brake\\\">\\n          <span>00</span>\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-warning\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Driver Score</h3>\\n        </div>\\n        <div class=\\\"panel-body driver_score\\\">\\n          <span>00</span>\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\\\"col-lg-2\\\">\\n      <div class=\\\"panel panel-danger\\\">\\n        <div class=\\\"panel-heading\\\">\\n          <h3 class=\\\"panel-title\\\">Fuel Guage</h3>\\n        </div>\\n        <div class=\\\"panel-body fuel\\\">\\n          <span>00</span>%\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./views/vehicle.html\n// module id = 165\n// module chunks = 0","var path = 'views/vehicle_list.html';\nvar html = \"<div class=\\\"row\\\">\\n  <div class=\\\"col-lg-12\\\">\\n    <div class=\\\"page-header\\\">\\n      <h1 id=\\\"tables\\\">Vehicles</h1>\\n    </div>\\n    <div class=\\\"bs-component\\\">\\n      <table class=\\\"table table-striped table-hover \\\">\\n        <thead>\\n          <tr>\\n            <th>Id</th>\\n            <th>Name</th>\\n<!--\\n            <th>Twilio SIM SID</th>\\n-->\\n            <th>Key</th>\\n            <th>Created</th>\\n            <th>Operations</th>\\n          </tr>\\n        </thead>\\n        <tbody>\\n          <tr ng-repeat=\\\"vehicle in vehicles\\\" class=\\\"jumbotron vehicle vehicle{{vehicle.info.id}}\\\" ng-class=\\\"{'text-success': vehicleAdded.info.id === vehicle.info.id}\\\">\\n            <td>{{ vehicle.info.id }}</td>\\n            <td>{{ vehicle.info.name }}</td>\\n<!--\\n            <td>{{ vehicle.info.sim_sid }}</td>\\n            <td>{{ vehicle.info.key }} <small ng-if=\\\"vehicle.info.secret\\\" class=\\\"text-warning\\\"><br/>Secret: {{ vehicle.info.secret }}</small></td>\\n-->\\n            <td>\\n              <div ng-if=\\\"vehicle.info.key\\\">{{ vehicle.info.key }} <small class=\\\"text-warning\\\"><br/>Secret: {{ vehicle.info.secret }}</small></div>\\n              <div ng-if=\\\"!vehicle.info.key\\\" class=\\\"text-danger\\\">Hidden</div>\\n            </td>\\n            <td>{{ vehicle.info.created_at }}</td>\\n<!--\\n            <td><a href=\\\"#!/vehicles/{{ vehicle.info.id }}/edit\\\" class=\\\"btn btn-xs btn-success\\\">Edit</a></td>\\n-->\\n            <td>\\n              <button ng-click=\\\"generateVehicleKey(vehicle.info.id)\\\" class=\\\"btn btn-xs btn-danger\\\">Generate New Key</button>\\n              <button ng-click=\\\"deleteVehicle(vehicle.info.id)\\\" class=\\\"btn btn-xs btn-danger\\\">Delete</button>\\n            </td>\\n          </tr>\\n        </tbody>\\n      </table>\\n    <div id=\\\"source-button\\\" class=\\\"btn btn-primary btn-xs\\\" style=\\\"display: none;\\\">&lt; &gt;</div></div>\\n  </div>\\n  <div class=\\\"divider col-lg-10 bg-primary\\\"></div>\\n</div>\\n\\n<a class=\\\"btn btn-primary add-vehicle-show\\\">Add New Vehicle</a>\\n\\n<div class=\\\"row add-vehicle\\\">\\n  <div class=\\\"col-lg-6\\\">\\n    <form class=\\\"form-horizontal\\\" ng-submit=\\\"addVehicle()\\\">\\n      <fieldset>\\n        <legend>New Vehicle</legend>\\n        <div class=\\\"form-group\\\">\\n          <label for=\\\"id\\\" class=\\\"col-lg-2 control-label\\\">Id</label>\\n          <div class=\\\"col-lg-10\\\">\\n            <input type=\\\"text\\\" class=\\\"form-control\\\" ng-model=\\\"newVehicle.id\\\" id=\\\"id\\\" placeholder=\\\"Id\\\">\\n          </div>\\n        </div>\\n\\n        <div class=\\\"form-group\\\">\\n          <label for=\\\"name\\\" class=\\\"col-lg-2 control-label\\\">Name</label>\\n          <div class=\\\"col-lg-10\\\">\\n            <input type=\\\"text\\\" class=\\\"form-control\\\" ng-model=\\\"newVehicle.name\\\" id=\\\"name\\\" placeholder=\\\"Name\\\">\\n          </div>\\n        </div>\\n\\n<!--\\n        <div class=\\\"form-group\\\">\\n          <label for=\\\"sim_sid\\\" class=\\\"col-lg-2 control-label\\\">Twilio SIM SID</label>\\n          <div class=\\\"col-lg-10\\\">\\n            <input type=\\\"text\\\" class=\\\"form-control\\\" ng-model=\\\"newVehicle.sim_sid\\\" id=\\\"sim_sid\\\" placeholder=\\\"Twilio SIM SID\\\">\\n          </div>\\n        </div>\\n-->\\n\\n        <div class=\\\"form-group\\\">\\n          <div class=\\\"col-lg-10 col-lg-offset-2\\\">\\n            <button type=\\\"submit\\\" class=\\\"btn btn-primary\\\">Submit</button>\\n            <button type=\\\"reset\\\" class=\\\"btn btn-default add-vehicle-cancel\\\">Cancel</button>\\n          </div>\\n        </div>\\n\\n        <p class=\\\"text-warning\\\" id=\\\"add-vehicle-failed\\\"></p>\\n      </fieldset>\\n    </form>\\n  </div>\\n</div>\\n\";\nwindow.angular.module('ng').run(['$templateCache', function(c) { c.put(path, html) }]);\nmodule.exports = path;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./views/vehicle_list.html\n// module id = 166\n// module chunks = 0","module.exports = Twilio.Sync;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Twilio.Sync\"\n// module id = 171\n// module chunks = 0","require(\"../views/vehicle.html\");\n\nvar $ = require(\"jquery\");\n\nvar map;\nvar infowindows = {};\n\nvar vehicleView = {\n  initMapElement: function (mapElementName) {\n    var map = new google.maps.Map(document.getElementById(mapElementName), {\n      zoom: 14\n    });\n    return map;\n  },\n\n  addDataToMap: function (map, infowindows, data) {\n    var latLon = { lat: data.lat, lng: data.lon}\n    var marker = new google.maps.Marker({\n      position: latLon,\n      map: map,\n      title: String(data.id)\n    });\n\n    var content_string = '<div class=\"infowindow-label\"> \\\n                            <h1>Point data</h1> \\\n                            <p><span class=\"label label-default\">Distance:</span> <span class=\"value\">'+(data.miles).toFixed(0)+' Miles</span></p> \\\n                            <p><span class=\"label label-default\">Speed:</span> <span class=\"value\">'+(data.speed).toFixed(0)+' mph</span></p> \\\n                            <p><span class=\"label label-default\">Fuel:</span> <span class=\"value\">'+(data.fuel).toFixed(0)+'%</span></p> \\\n                          </div>';\n\n    var infowindow = new google.maps.InfoWindow({\n      content: content_string,\n    });\n    infowindows[data.id] = infowindow;\n    map.panTo(marker.getPosition());\n\n    google.maps.event.addListener(marker, 'click', function(e) {\n      if(current_infowindow) {\n        current_infowindow.close();\n      }\n      infowindows[this.getTitle()].open(map, this);\n      current_infowindow = infowindows[this.getTitle()];\n    });\n  },\n\n  updateStats: function (vehicleElemementName, stats) {\n    if (!stats) return;\n\n    $('.' + vehicleElemementName + ' .miles span').text(stats.miles);\n    $('.' + vehicleElemementName + ' .speed span').text(stats.avg_speed);\n    $('.' + vehicleElemementName + ' .driver_score span').text(100 - stats.driver_score);\n    $('.' + vehicleElemementName + ' .fuel span').text(stats.fuel);\n    $('.' + vehicleElemementName + ' .brake span').text(stats.brake);\n\n    var runtime_string;\n    if(stats.runtime < 60) {\n      runtime_string = stats.runtime+' seconds';\n    } else if(stats.runtime < 3600) {\n      runtime_string = (stats.runtime/60).toFixed(0)+\" minutes\";\n    } else {\n      var hours = Math.floor(runtime/3600);\n      var minutes = ((runtime - (hours*3600))/60).toFixed(0);\n      runtime_string = hours+\" hours and \"+minutes+\" minutes\";\n    }\n\n    $('.' + vehicleElemementName + ' .runtime').text(runtime_string);    \n  },\n\n  init: function () {\n    map = vehicleView.initMapElement('map');\n  },\n\n  onVehicleData: function (vehicle, data) {\n    vehicleView.addDataToMap(map, infowindows, data);\n  },\n\n  onVehicleStats: function (vehicle, stats) {\n    vehicleView.updateStats('vehicle', stats);\n  }  \n};\n\nmodule.exports = vehicleView;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./js/vehicleView.js\n// module id = 6\n// module chunks = 0"],"sourceRoot":""}